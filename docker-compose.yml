# ============================================
# AdPilot Production Docker Compose
# For Dokploy deployment (Cloud Convex)
# ============================================

services:
  frontend:
    build:
      context: .
      dockerfile: Dockerfile.prod
      args:
        - VITE_CONVEX_URL=${VITE_CONVEX_URL}
        - VITE_REDIRECT_URI=${VITE_REDIRECT_URI:-https://${DOMAIN}/auth/callback}
        - VITE_TELEGRAM_BOT_USERNAME=${VITE_TELEGRAM_BOT_USERNAME:-Addpilot_bot}
    container_name: adpilot-frontend
    restart: always
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.frontend.rule=Host(`${DOMAIN}`) || Host(`www.${DOMAIN}`)"
      - "traefik.http.routers.frontend.entrypoints=websecure"
      - "traefik.http.routers.frontendtls.certresolver=letsencrypt"
      - "traefik.http.services.frontend.loadbalancer.server.port=3000"
