# ============================================
# AdPilot Docker Compose — Dokploy (Self-Hosted Convex)
# Dev: dev.aipilot.by → dev Convex backend
# ============================================

services:
  frontend:
    build:
      context: .
      dockerfile: Dockerfile.prod
      args:
        - VITE_CONVEX_URL=${VITE_CONVEX_URL}
        - VITE_REDIRECT_URI=${VITE_REDIRECT_URI}
        - VITE_TELEGRAM_BOT_USERNAME=${VITE_TELEGRAM_BOT_USERNAME}
        - VITE_CONVEX_SITE_URL=${VITE_CONVEX_SITE_URL}
    container_name: adpilot-frontend-dev
    restart: always
    expose:
      - "3000"
    networks:
      - dokploy-network
    environment:
      - NODE_ENV=production
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.frontend-dev.rule=Host(`${DOMAIN}`)"
      - "traefik.http.routers.frontend-dev.entrypoints=websecure"
      - "traefik.http.routers.frontend-dev.tls.certresolver=letsencrypt"
      - "traefik.http.services.frontend-dev.loadbalancer.server.port=3000"

networks:
  dokploy-network:
    external: true
